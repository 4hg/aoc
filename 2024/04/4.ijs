I =. 'm' freads 'input.txt'
F =. [: +/^:_ ('XMAS' ,: 'SAMX') (,:@[ E. ])"1 2/ ]
S =. F ((,:|:) , [/."2@(,:|.)) I
D =. (<0 1)&|:
G =.  +/ , 3 3 (2 = 1 #. [: , ('MAS' ,: 'SAM') -:"1 1/ D ,: [: D |."1);._3 I
echo S , G
exit 0
